/*!
 * @ProjectName micro-app
 * @Version 1.0.0
 * @Author lixinliang
 * @Update Thu Aug 11 2016 22:56:59 GMT+0800 (CST)
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.microApp=e():t.microApp=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";var n=r(1),i=n.userAgent,a=document.querySelector("script[micro-app]");if(!a){var o,l=r(1),s=l.show;l.createElement;a=(o=ciosreateElement("<script micro-app>"),s).call(o)}i.is.ios?i.is.safari?r(2).main(a):navigator.standalone?r(6).standalone(a):r(1).compatible(a):r(1).compatible(a),t.exports=a},function(t,e){"use strict";function r(){var t=[];for(var e in l){var r=l[e];null!==r&&t.push(e+"="+r)}location.hash=encodeURIComponent(t.join("&"))}var n=function(){function t(t,e){var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=t[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(s){i=!0,a=s}finally{try{!n&&l["return"]&&l["return"]()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=document,a=i.head;e.camel2hyphen=function(t){return t.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()})},e.compatible=function(t){["hash","filter"].forEach(function(e){t[e]=function(){return console.warn('micro-app: "'+e+'" is an empty function.'),this}})};var o=i.createElement("div");e.createElement=function(t){return o.innerHTML=t,o.firstElementChild},e.defineStaticProperty=function(t,e){return Object.defineProperty(this,t,{value:e,writable:!1,enumerable:!1,configurable:!1}),this},e.filters={},e.hashListener=function(t){function e(t){var e=t.indexOf("#");if(e>-1&&e<t.length-1){var n=t.substring(e+1);r.test(n)||console.warn('micro-app: "location.hash" is in use to save the params.')}}var r=new RegExp("(^|&)("+t.join("|")+")=");window.addEventListener("hashchange",function(t){e(t.newURL)}),e(location.href)};var l={};if(location.hash){var s=decodeURIComponent(location.hash.substring(1));s.split("&").forEach(function(t){var e=t.split("="),r=n(e,2),i=r[0],a=r[1];l[i]=a})}e.hash=function(t,e){return void 0===t?l:void 0===e?l[t]:(l[t]=e,r(),this)},e.hide=function(){return a.removeChild(this),this},e.NaF=function(t){return"function"==typeof t?NaF(t()):t},e.parseArgument=function(t){var e=/\(/.test(t),r=/\)/.test(t);if(!e&&!r)return[t,[]];try{if(!e)throw new SyntaxError('[micro-app] Missing "(" before argument list.');if(!r)throw new SyntaxError('[micro-app] Missing ")" after argument list.');if(!/\)$/.test(t))throw new SyntaxError('[micro-app] Unexpected end of "'+t.match(/.*(\).*$)/)[1]+'".');var i=t.match(/(.*?)\((.*)\)$/),a=n(i,3),o=a[1],l=a[2];return[o,JSON.parse("["+l+"]")]}catch(s){return setTimeout(function(){throw s},0),[""]}},e.parseFilter=function(t){return t?t.substring(1).split("|"):[]},e.parseUrl=function(t){var e=i.createElement("a");return e.href=t,e};var c=Element.prototype,u=c.setAttribute,f=c.removeAttribute;e.setAttribute=function(t,e){return null===e?f.call(this,t):u.call(this,t,e),this},e.show=function(){return a.appendChild(this),this};var p=navigator.userAgent;e.userAgent={is:{ios:/\(i[^;]+;( U;)? CPU.+Mac OS X/i.test(p),safari:/\bversion\/([0-9.]+(?: beta)?)(?: mobile(?:\/[a-z0-9]+)?)? safari\//i.test(p)},device:/iPad/i.test(p)?"pad":"phone",os:parseInt((p.match(/\bcpu(?: iphone)? os /i.test(p)?/\bcpu(?: iphone)? os ([0-9._]+)/i:/\biph os ([0-9_]+)/i)||[,0])[1])>6?7:6}},function(t,e,r){"use strict";var n=function(){function t(t,e){var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=t[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(s){i=!0,a=s}finally{try{!n&&l["return"]&&l["return"]()}finally{if(i)throw a}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=r(1),a=r(3),o=r(4),l=r(5);e.main=function(t){var e,r=Object.prototype.toString.call([]);(0,i.hashListener)(["href"]),i.defineStaticProperty.call(t,"filter",function(t,e){if(arguments.length<2)throw new TypeError("[micro-app] 2 arguments required, but only "+arguments.length+" present.");if("string"!=typeof t)throw new TypeError("[micro-app] A valid filter name should be string.");if(!t)throw new TypeError("[micro-app] A valid filter name should not be empty string.");if(/[\||\(|\)]/.test(t))throw new TypeError('[micro-app] "'+t+'" is not a valid filter name, "'+t.match(/[\||\(|\)]/)[0]+'" is not allowed.');if("function"!=typeof e)throw new TypeError("[micro-app] The second argument must be a function.");return i.filter[t]=e,this}),t.filters("precomposed",function(){this.rel="apple-touch-icon-precomposed"}),t.filters("autosize",function(){var t="apple-touch-startup-image"===this.getAttribute("rel")?"splash":"icon",e=autosize(t);if(e)for(var r in e)this.setAttribute(r,e[r])});var s=(0,i.createElement)('<meta name="apple-mobile-web-app-capable" content="yes">'),c=(0,i.createElement)('<meta name="apple-mobile-web-app-status-bar-style">'),u=(0,i.createElement)('<meta name="apple-mobile-web-app-title">');(e=(e=(e=(e=(e=(e=(e=(e=(e=o.defineProperty.call(t,{name:"capable",onChange:function(e,r){i.setAttribute.call(t,this.name,e),null===e&&i.hide.call(s),null===r&&i.show.call(s)}}),o.defineProperty).call(e,{name:"statusBarStyle",hyphenName:(0,i.camel2hyphen)("statusBarStyle"),onChange:function(e,r){i.setAttribute.call(t,this.hyphenName,e),i.setAttribute.call(c,"content",e),null===e&&i.hide.call(c),null===r&&i.show.call(c)}}),o.defineProperty).call(e,{name:"title",onChange:function(e,r){i.setAttribute.call(t,this.name,e),i.setAttribute.call(u,"content",e),null===e&&i.hide.call(u),null===r&&i.show.call(u)}}),o.defineProperty).call(e,{result:[],name:"icon",code:'<link rel="apple-touch-icon">',onChange:function(e,a){var o=e instanceof Array?e.slice(0):null===e?[]:[e],s=this.result;this.result=(0,l.createMultiElement)(o,s,{code:this.code,attribute:"href",success:function(t){var e=this,r=!1;(0,i.parseFilter)((0,i.parseUrl)(t).hash).forEach(function(t){if(!r&&""!==t){var a=(0,i.parseArgument)(t),o=n(a,2),l=o[0],s=o[1],c=i.filter[l];"function"==typeof c&&(r=NaF(c.apply(e,s))===!1)}})}}),i.setAttribute.call(t,this.name,e instanceof Array?r:e)}}),o.defineProperty).call(e,{result:[],name:"splash",code:'<link rel="apple-touch-startup-image">',onChange:function(e,a){var o=e instanceof Array?e.slice(0):null===e?[]:[e],s=this.result;this.result=(0,l.createMultiElement)(o,s,{code:this.code,attribute:"href",success:function(t){var e=this,r=!1;(0,i.parseFilter)((0,i.parseUrl)(t).hash).forEach(function(t){if(!r&&""!==t){var a=(0,i.parseArgument)(t),o=n(a,2),l=o[0],s=o[1],c=i.filter[l];"function"==typeof c&&(r=NaF(c.apply(e,s))===!1)}})}}),i.setAttribute.call(t,this.name,e instanceof Array?r:e)}}),o.defineProperty).call(e,{name:"href",onChange:function(e,r){i.setAttribute.call(t,this.name,e),(0,i.hash)(this.name,e)}}),a.override).call(e,"getAttribute",function(t,e){var r=n(e,1),i=r[0];if(i in o.defineProperty)return t.stopPropagation(),this[i]}),a.override).call(e,"setAttribute",function(t,e){var r=n(e,2),i=r[0],a=r[1];if(i in o.defineProperty)return t.stopPropagation(),this[i]=a}),a.override).call(e,"removeAttribute",function(t,e){var r=n(e,1),i=r[0];if(i in o.defineProperty)return t.stopPropagation(),this[i]=null}),i.defineStaticProperty).call(e,"hash",i.hash)}},function(t,e,r){"use strict";var n=r(1);e.override=function(t,e){var r=this[t];return"function"==typeof r&&n.defineStaticProperty.call(this,t,function(){var t=!0,n=e.call(this,{stopPropagation:function(){t=!1}},arguments);return t?r.apply(this,arguments):n}),this}},function(t,e,r){"use strict";var n=r(1);e.defineProperty=function(t){var e=t.name,r=t.hyphenName||e,i=void 0;void 0===t.value?i=t.value=this.getAttribute(r):this.setAttribute(r,i=t.value),null!==i&&t.onChange(i,null);var a={get:function(){return t.value},set:function(e){return e=(0,n.NaF)(e),e!==t.value&&t.onChange(e,t.value),t.value=e},enumerable:!1};return Object.defineProperty(this,e,a),e!=r?(Object.defineProperty(this,r,a),defineProperty[e]=defineProperty[r]=!0,this):(defineProperty[e]=!0,this)}},function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},i=r(1),a=Element.prototype.getAttribute;e.createMultiElement=function(t,e,r){var o=[],l=r.attribute;e.forEach(function(t){i.hide.call(t)});for(var s=t.length,c=0;c<s;c++){var u=(0,i.NaF)(t[c]);if(null===u);else{var f,p=(f=(0,i.createElement)(r.code),i.show).call(f);if("object"==("undefined"==typeof u?"undefined":n(u))){i.setAttribute.call(p,l,void 0);for(var h in u)i.setAttribute.call(p,h,(0,i.NaF)(u[h]))}else i.setAttribute.call(p,l,u);var m=a.call(p,l);i.setAttribute.call(p,"original-"+l,m),m.indexOf("#")>-1&&i.setAttribute.call(p,l,m.split("#")[0]),r.success&&r.success.call(p,m),o.push(p)}}return o}},function(t,e,r){"use strict";var n=r(1);e.standalone=function(){var t=(0,n.hash)("href");if(t){var e=doc.createEvent("CustomEvent");e.initEvent("redirect",!1,!0),window.dispatchEvent(e)&&location.replace(t)}}}])});